import numpy as np
import matplotlib.pyplot as plt
# Results for 4 vertices
E2_plot = np.arange(-0.33, 0.0, 0.01)
E2_plot = np.insert(E2_plot, 0, -1/3)  

results_4 = [
    0.183594, 0.187598, 0.200098, 0.212695, 0.225488, 0.238477, 0.251758, 0.265234, 0.278906,
    0.292969, 0.307227, 0.321777, 0.336719, 0.351953, 0.367578, 0.383594, 0.400098, 0.415039, 0.420020,
    0.425098, 0.430078, 0.435059, 0.440039, 0.445020, 0.450098, 0.455078, 0.460059, 0.465039, 0.470020,
    0.475098, 0.480078, 0.485059, 0.490039, 0.495020
]

# Results for 5 vertices
results_5 = [
    0.183594, 0.187598, 0.200098, 0.212695, 0.225488, 0.238477, 0.250098, 0.259863, 0.269922,
    0.280078, 0.290332, 0.300879, 0.311523, 0.322363, 0.333398, 0.344629, 0.355957, 0.367578, 0.379395,
    0.391309, 0.403516, 0.416016, 0.428613, 0.441504, 0.450098, 0.455078, 0.460059, 0.465039, 0.470020,
    0.475098, 0.480078, 0.485059, 0.490039, 0.495020
]

# Results for 6 vertices
results_6 = [
    0.177246, 0.185547, 0.200098, 0.212695, 0.225488, 0.238477, 0.250098, 0.259863, 0.269922,
    0.279395, 0.288477, 0.297656, 0.307031, 0.316504, 0.326172, 0.335938, 0.345898, 0.356055, 0.366309,
    0.376758, 0.387402, 0.398145, 0.409082, 0.420215, 0.431445, 0.442871, 0.454492, 0.465039, 0.470020,
    0.475098, 0.480078, 0.485059, 0.490039, 0.495020
]

# Results for 7 vertices
results_7 = [
    0.163574, 0.170801, 0.193652, 0.212695, 0.225488, 0.238477, 0.250098, 0.259863, 0.269922,
    0.279395, 0.288477, 0.297168, 0.305859, 0.314746, 0.323730, 0.332910, 0.342187, 0.351660, 0.361230,
    0.370996, 0.380859, 0.390918, 0.401074, 0.411426, 0.421875, 0.432422, 0.443262, 0.454102, 0.465137,
    0.475098, 0.480078, 0.485059, 0.490039, 0.495020
]

# Results for 8 vertices
results_8 = [
    0.163574, 0.170801, 0.193652, 0.212695, 0.225488, 0.238477, 0.250098, 0.259863, 0.269922,
    0.279395, 0.288477, 0.297168, 0.305664, 0.314160, 0.322754, 0.331445, 0.340430, 0.349414, 0.358691,
    0.368066, 0.377539, 0.387109, 0.396875, 0.406836, 0.416797, 0.426953, 0.437305, 0.447754, 0.458301,
    0.468945, 0.479785, 0.485059, 0.490039, 0.495020
]

# Results for 9 vertices
results_9 = [
    0.163574, 0.170801, 0.193652, 0.212695, 0.225488, 0.238477, 0.250098, 0.259863, 0.269922,
    0.279395, 0.288477, 0.297168, 0.305664, 0.313965, 0.322266, 0.330762, 0.339453, 0.348242, 0.357227,
    0.366309, 0.375586, 0.384961, 0.394434, 0.404102, 0.413867, 0.423730, 0.433691, 0.443848, 0.454102,
    0.464551, 0.475000, 0.485059, 0.490039, 0.495020
]

# Results for 10 vertices
results_10 = [
    0.163574, 0.170801, 0.193652, 0.212695, 0.225488, 0.238477, 0.250098, 0.259863, 0.269922,
    0.279395, 0.288477, 0.297168, 0.305664, 0.313965, 0.322070, 0.330371, 0.338867, 0.347461, 0.356348,
    0.365234, 0.374316, 0.383496, 0.392871, 0.402344, 0.411914, 0.421582, 0.431445, 0.441406, 0.451465,
    0.461621, 0.471875, 0.482324, 0.490039, 0.495020
]

# Results for 11 vertices
results_11 = [
    0.162305, 0.168262, 0.186719, 0.206152, 0.225488, 0.238477, 0.250098, 0.259863, 0.269922,
    0.279395, 0.288477, 0.297168, 0.305664, 0.313965, 0.321973, 0.330176, 0.338477, 0.346973, 0.355664,
    0.364551, 0.373437, 0.382520, 0.391797, 0.401074, 0.410547, 0.420117, 0.429785, 0.439648, 0.449512,
    0.459570, 0.469727, 0.479980, 0.490039, 0.495020
]

# Results for 12 vertices
results_12 = [
    0.159668, 0.165234, 0.182520, 0.200684, 0.220117, 0.238477, 0.250098, 0.259863, 0.269922,
    0.279395, 0.288477, 0.297168, 0.305664, 0.313965, 0.321973, 0.329980, 0.338281, 0.346680, 0.355273,
    0.363965, 0.372852, 0.381836, 0.390918, 0.400195, 0.409570, 0.419043, 0.428613, 0.438379, 0.448145,
    0.458105, 0.468164, 0.478320, 0.488574, 0.495020
]


NSI_E1 = np.arange(0.21, 0.50, 0.01).round(2).astype(float)
NSI_E2 = np.array([-0.3333, -0.3206, -0.3081, -0.2958, -0.2838, -0.2721, -0.2606,
                   -0.2493, -0.2383, -0.2274, -0.2168, -0.2063, -0.1960, -0.1859,
                   -0.1759, -0.1661, -0.1564, -0.1469, -0.1375, -0.1283, -0.1191,
                   -0.1101, -0.1013, -0.0925, -0.0838, -0.0753, -0.0600, -0.0400, 
                   -0.0200, 0])

E1ternary = [0.175 , 0.1875 ,0.2,    0.2125, 0.225,  0.2375, 0.25 ,  0.2625, 0.275,  
             0.2875 , 0.3,    0.3125, 0.325,  0.3375, 0.35,   0.3625, 0.375,  0.3875, 
             0.4,    0.4125,0.425,  0.4375, 0.45,   0.4625, 0.475,  0.4875, 0.5]
E2ternary = [-3.33333333e-01, -3.19659055e-01 ,-3.05925365e-01, -2.92205698e-01,
             -2.78747859e-01 ,-2.65342926e-01 ,-2.52950581e-01 ,-2.40673388e-01,
             -2.29472786e-01 ,-2.18933024e-01 ,-2.08318774e-01 ,-1.96822165e-01,
             -1.87247622e-01 ,-1.76528844e-01 ,-1.62336664e-01 ,-1.48248986e-01,
             -1.34014435e-01 ,-1.19780379e-01 ,-1.05666008e-01 ,-9.17544873e-02,
             -7.80700339e-02 ,-6.45965142e-02 ,-5.13208155e-02 ,-3.82320057e-02,
             -2.53207881e-02 ,-1.25791301e-02, -6.03319070e-08]

# Interpoler les valeurs de NSI_E2 aux points d'Ã©chantillonnage de E1ternary
NSI_E2_interp = np.interp(E1ternary, NSI_E1, NSI_E2)

# Tracer les courbes
plt.figure(figsize=(15, 8))


# Remplir l'espace entre les deux courbes
plt.fill_between(E1ternary, E2ternary, NSI_E2_interp,  color='yellow', label = "Unknown Region",alpha=0.5)

E1 = np.arange(0.1, 0.51, 0.01).round(2).astype(float)
E2_condition = np.maximum(-1/3, 2*E1 - 1)
plt.fill_between(E1, E2_condition, -0.35, color='grey', alpha=0.7, label='Unfeasible Region')

E2_below_NSI = np.minimum(NSI_E2, np.interp(NSI_E1, E1, E2_condition))
NSI_E2_condition = np.maximum(-1/3, 2*NSI_E1 - 1)
plt.fill_between(NSI_E1, NSI_E2, NSI_E2_condition, color='blue', alpha=0.3, label='Excluded by NSI')



plt.plot(results_4, E2_plot, label = 4)
plt.plot(results_5, E2_plot, label = 5)
plt.plot(results_6, E2_plot, label = 6)
plt.plot(results_7, E2_plot, label = 7)
plt.plot(results_8, E2_plot, label = 8)
plt.plot(results_9, E2_plot, label = 9)
plt.plot(results_10, E2_plot, label = 10)
plt.plot(results_11, E2_plot, label = 11)
plt.plot(results_12, E2_plot, label = 12)



plt.legend()
plt.grid(True)
plt.ylabel('E2 Values')
plt.xlabel('E1 Values')
plt.title('Limits of Unfeasability for each Inflation composed of the previous')
plt.show()
#plt.savefig("plot_inflation_contained_12.pdf")
