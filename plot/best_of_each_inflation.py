import numpy as np
import matplotlib.pyplot as plt

E2 = np.arange(-0.33, 0.0, 0.01)
E2 = np.insert(E2, 0, -1/3)  


E1_4_vertices = [
    0.183545, 0.187549, 0.200049, 0.212646, 0.225439, 0.238428, 
    0.251709, 0.265186, 0.278857, 0.292920, 0.307178, 0.321729, 0.336670, 
    0.351904, 0.367529, 0.383545, 0.400049, 0.414990, 0.419971, 0.425049, 
    0.430029, 0.435010, 0.439990, 0.444971, 0.450049, 0.455029, 0.460010, 
    0.464990, 0.469971, 0.475049, 0.480029, 0.485010, 0.489990, 0.494971
]

E1_5_vertices = [
    0.200049, 0.202979, 0.212158, 0.221338, 0.230811, 0.240283, 
    0.250049, 0.259814, 0.269873, 0.280029, 0.290283, 0.300830, 0.311475, 
    0.322314, 0.333350, 0.344580, 0.355908, 0.367529, 0.379346, 0.391260, 
    0.403467, 0.415967, 0.428564, 0.441455, 0.450049, 0.455029, 0.460010, 
    0.464990, 0.469971, 0.475049, 0.480029, 0.485010, 0.489990, 0.494971
]

E1_6_vertices = [
    0.210107, 0.212744, 0.220459, 0.228467, 0.236572, 0.244775, 
    0.253174, 0.261768, 0.270459, 0.279346, 0.288428, 0.297607, 0.306982, 
    0.316455, 0.326123, 0.335889, 0.345850, 0.356006, 0.366260, 0.376709, 
    0.387354, 0.398096, 0.409033, 0.420166, 0.431396, 0.442822, 0.454443, 
    0.464990, 0.469971, 0.475049, 0.480029, 0.485010, 0.489990, 0.494971
]

E1_7_vertices = [
    0.166064, 0.174463, 0.203564, 0.234131, 0.241357, 0.248779, 
    0.256396, 0.264111, 0.272119, 0.280322, 0.288623, 0.297119, 0.305811, 
    0.314697, 0.323682, 0.332861, 0.342139, 0.351611, 0.361182, 0.370947, 
    0.380811, 0.390869, 0.401025, 0.411377, 0.421826, 0.432373, 0.443213, 
    0.454053, 0.465088, 0.475049, 0.480029, 0.485010, 0.489990, 0.494971
]

E1_8_vertices = [
    0.190576, 0.194189, 0.205811, 0.218311, 0.231787, 0.246533, 
    0.259326, 0.266455, 0.273877, 0.281494, 0.289307, 0.297412, 0.305615, 
    0.314111, 0.322705, 0.331396, 0.340381, 0.349365, 0.358643, 0.368018, 
    0.377490, 0.387061, 0.396826, 0.406787, 0.416748, 0.426904, 0.437256, 
    0.447705, 0.458252, 0.468896, 0.479736, 0.485010, 0.489990, 0.494971
]

E1_9_vertices = [
    0.202100, 0.205029, 0.213916, 0.223291, 0.233057, 0.243408, 
    0.254248, 0.265576, 0.275635, 0.282764, 0.290186, 0.297803, 0.305811, 
    0.313916, 0.322217, 0.330713, 0.339404, 0.348193, 0.357178, 0.366260, 
    0.375537, 0.384912, 0.394385, 0.404053, 0.413818, 0.423682, 0.433643, 
    0.443799, 0.454053, 0.464502, 0.474951, 0.485010, 0.489990, 0.494971
]

E1_10_vertices = [
    0.185596, 0.195459, 0.219189, 0.227979, 0.236279, 0.245068, 
    0.254150, 0.263623, 0.273486, 0.283740, 0.291064, 0.298389, 0.306006, 
    0.313916, 0.322021, 0.330322, 0.338818, 0.347412, 0.356299, 0.365186, 
    0.374268, 0.383447, 0.392822, 0.402295, 0.411865, 0.421533, 0.431396, 
    0.441357, 0.451416, 0.461572, 0.471826, 0.482275, 0.489990, 0.494971
]

E1_11_vertices = [
    0.171924, 0.178174, 0.199561, 0.226123, 0.238428, 0.247412, 
    0.255518, 0.264014, 0.272803, 0.281982, 0.291455, 0.298877, 0.306299, 
    0.314014, 0.321924, 0.330127, 0.338428, 0.346924, 0.355615, 0.364502, 
    0.373389, 0.382471, 0.391748, 0.401025, 0.410498, 0.420068, 0.429736, 
    0.439600, 0.449463, 0.459521, 0.469678, 0.479932, 0.489990, 0.494971
]

E1_12_vertices = [
    0.177002, 0.181201, 0.195166, 0.211572, 0.232471, 0.246826, 
    0.256787, 0.264990, 0.273193, 0.281592, 0.290479, 0.299561, 0.306592, 
    0.314111, 0.321924, 0.329932, 0.338232, 0.346631, 0.355225, 0.363916, 
    0.372803, 0.381787, 0.390869, 0.400146, 0.409521, 0.418994, 0.428564, 
    0.438330, 0.448096, 0.458057, 0.468115, 0.478271, 0.488525, 0.494971
]

results_12_previous = [
    0.159668, 0.165234, 0.182520, 0.200684, 0.220117, 0.238477, 0.250098, 0.259863, 0.269922,
    0.279395, 0.288477, 0.297168, 0.305664, 0.313965, 0.321973, 0.329980, 0.338281, 0.346680, 0.355273,
    0.363965, 0.372852, 0.381836, 0.390918, 0.400195, 0.409570, 0.419043, 0.428613, 0.438379, 0.448145,
    0.458105, 0.468164, 0.478320, 0.488574, 0.495020
]


def find_minimum_and_origin(*lists):
    min_values = []
    min_sources = []
    
    for values in zip(*lists):
        min_value = min(values)
        min_values.append(min_value)
        indices = [i for i, x in enumerate(values) if x == min_value]
        min_source = min(indices) + 4  # +4 pour ajuster au nombre de vertices
        min_sources.append(min_source)
    
    return min_values, min_sources

E1_min_values, E1_sources = find_minimum_and_origin(
    E1_4_vertices, E1_5_vertices, E1_6_vertices, E1_7_vertices, E1_8_vertices, 
    E1_9_vertices, E1_10_vertices, E1_11_vertices, E1_12_vertices
)
colors = {
    4: 'red', 
    5: 'green', 
    6: 'blue', 
    7: 'purple', 
    8: 'orange', 
    9: 'yellow', 
    10: 'pink', 
    11: 'cyan', 
    12: 'magenta'
}

labels = {
    4: '4 Vertices', 
    5: '5 Vertices', 
    6: '6 Vertices', 
    7: '7 Vertices', 
    8: '8 Vertices', 
    9: '9 Vertices', 
    10: '10 Vertices', 
    11: '11 Vertices', 
    12: '12 Vertices'
}

plt.figure(figsize=(15, 8))

for i in range(len(E1_min_values) - 1):
    source = E1_sources[i]
    color = colors[source]
    label = labels[source]
    plt.plot([E1_min_values[i], E1_min_values[i+1]], [E2[i], E2[i+1]], marker='o',markersize=3 ,color=color, label=label)

NSI_E1 = np.arange(0.21, 0.50, 0.01).round(2).astype(float)
NSI_E2 = np.array([-0.3333, -0.3206, -0.3081, -0.2958, -0.2838, -0.2721, -0.2606,
                   -0.2493, -0.2383, -0.2274, -0.2168, -0.2063, -0.1960, -0.1859,
                   -0.1759, -0.1661, -0.1564, -0.1469, -0.1375, -0.1283, -0.1191,
                   -0.1101, -0.1013, -0.0925, -0.0838, -0.0753, -0.0600, -0.0400, 
                   -0.0200, 0])

E1ternary = [0.175 , 0.1875 ,0.2,    0.2125, 0.225,  0.2375, 0.25 ,  0.2625, 0.275,  
             0.2875 , 0.3,    0.3125, 0.325,  0.3375, 0.35,   0.3625, 0.375,  0.3875, 
             0.4,    0.4125,0.425,  0.4375, 0.45,   0.4625, 0.475,  0.4875, 0.5]
E2ternary = [-3.33333333e-01, -3.19659055e-01 ,-3.05925365e-01, -2.92205698e-01,
             -2.78747859e-01 ,-2.65342926e-01 ,-2.52950581e-01 ,-2.40673388e-01,
             -2.29472786e-01 ,-2.18933024e-01 ,-2.08318774e-01 ,-1.96822165e-01,
             -1.87247622e-01 ,-1.76528844e-01 ,-1.62336664e-01 ,-1.48248986e-01,
             -1.34014435e-01 ,-1.19780379e-01 ,-1.05666008e-01 ,-9.17544873e-02,
             -7.80700339e-02 ,-6.45965142e-02 ,-5.13208155e-02 ,-3.82320057e-02,
             -2.53207881e-02 ,-1.25791301e-02, -6.03319070e-08]

NSI_E2_interp = np.interp(E1ternary, NSI_E1, NSI_E2)

plt.fill_between(E1ternary, E2ternary, NSI_E2_interp, interpolate=True, color='yellow', label = "Unknown Region",alpha=0.5)

E1 = np.arange(0.1, 0.51, 0.01).round(2).astype(float)
E2_condition = np.maximum(-1/3, 2*E1 - 1)
plt.fill_between(E1, E2_condition, -0.35, color='grey', alpha=0.7, label='Unfeasible Region')

E2_below_NSI = np.minimum(NSI_E2, np.interp(NSI_E1, E1, E2_condition))
NSI_E2_condition = np.maximum(-1/3, 2*NSI_E1 - 1)
plt.fill_between(NSI_E1, NSI_E2, NSI_E2_condition, color='blue', alpha=0.3, label='Excluded by NSI')
plt.plot(results_12_previous, E2, label='Inflation 12 Previous', color='firebrick')
handles, labels = plt.gca().get_legend_handles_labels()
by_label = dict(zip(labels, handles))  # Enl√®ve les doublons
plt.legend(by_label.values(), by_label.keys())


plt.xlabel('E1 Values')
plt.ylabel('E2 Values')
plt.title('Best of each Single Inflation from 4 to 12 vs. Inflation 12 containing previous one')
plt.grid(True)
plt.savefig("duel.pdf")
#plt.show()